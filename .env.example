# =============================================================================
# ENVIRONMENT CONFIGURATION
# =============================================================================
# Copy this file to .env and fill in your values
# NEVER commit .env to version control
# =============================================================================

# -----------------------------------------------------------------------------
# Environment
# -----------------------------------------------------------------------------
NODE_ENV=production
DEPLOYMENT_ENV=local  # local | staging | production

# -----------------------------------------------------------------------------
# API Gateway
# -----------------------------------------------------------------------------
API_GATEWAY_HOST=0.0.0.0
API_GATEWAY_PORT=8000
API_GATEWAY_WORKERS=4

# JWT Secret (Generate: openssl rand -hex 32)
JWT_SECRET=your-secret-key-change-this-in-production
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=24

# CORS
CORS_ORIGINS=http://localhost:3000,http://localhost:5173

# -----------------------------------------------------------------------------
# External APIs
# -----------------------------------------------------------------------------
# Claude API (Required for Tier 1)
CLAUDE_API_KEY=your_claude_api_key_here
CLAUDE_MODEL=claude-sonnet-4.5-20250929
CLAUDE_MAX_TOKENS=4096
CLAUDE_TIMEOUT=30

# -----------------------------------------------------------------------------
# ML Model Service URLs (Internal Docker Network)
# -----------------------------------------------------------------------------
MEDIAPIPE_URL=http://mediapipe:8001
OPENCV_URL=http://opencv:8003
SHIFAA_UNET_URL=http://shifaa-unet:8004
FFHQ_WRINKLE_URL=http://ffhq-wrinkle:8005
SKIN_TYPE_URL=http://skin-type:8006
SPOTS_DETECTION_URL=http://spots-detection:8007
ACNE_DETECTION_URL=http://acne-detection:8008
SAM_URL=http://sam:8009
CLAUDE_API_URL=http://claude-api:8010

# Tier 2 Models (Optional)
UNET_DARK_CIRCLES_URL=http://unet-dark-circles:8011
UNET_REDNESS_URL=http://unet-redness:8012
EFFICIENTNET_TEXTURE_URL=http://efficientnet-texture:8013

# -----------------------------------------------------------------------------
# Infrastructure Services
# -----------------------------------------------------------------------------
IMAGE_STORAGE_URL=http://image-storage:8022
USER_HISTORY_URL=http://user-history:8023
RECOMMENDATION_URL=http://recommendation:8021

# -----------------------------------------------------------------------------
# Database
# -----------------------------------------------------------------------------
DATABASE_URL=postgresql://postgres:postgres@postgres:5432/facial_analysis
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=facial_analysis

# Database Pool Settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10

# -----------------------------------------------------------------------------
# Redis Cache
# -----------------------------------------------------------------------------
REDIS_URL=redis://redis:6379/0
REDIS_PASSWORD=
REDIS_DB=0

# Cache TTL (seconds)
CACHE_TTL_RESULTS=3600
CACHE_TTL_MODELS=86400

# -----------------------------------------------------------------------------
# MinIO Storage (S3-compatible)
# -----------------------------------------------------------------------------
MINIO_ENDPOINT=minio:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_BUCKET=facial-analysis-images
MINIO_USE_SSL=false

# For external access (not in Docker network)
MINIO_EXTERNAL_ENDPOINT=localhost:9000

# -----------------------------------------------------------------------------
# Image Processing
# -----------------------------------------------------------------------------
MAX_IMAGE_SIZE_MB=10
MAX_IMAGE_DIMENSION=4096
IMAGE_QUALITY=85
THUMBNAIL_SIZE=200

# Allowed formats
ALLOWED_IMAGE_FORMATS=jpg,jpeg,png,webp

# -----------------------------------------------------------------------------
# Feature Flags
# -----------------------------------------------------------------------------
ENABLE_MEDIAPIPE=true
ENABLE_OPENCV=true
ENABLE_SHIFAA_UNET=true
ENABLE_FFHQ_WRINKLE=true
ENABLE_SKIN_TYPE=true
ENABLE_SPOTS_DETECTION=true
ENABLE_ACNE_DETECTION=true
ENABLE_SAM=true
ENABLE_CLAUDE_API=true

# Tier 2 Models
ENABLE_UNET_DARK_CIRCLES=false
ENABLE_UNET_REDNESS=false
ENABLE_EFFICIENTNET_TEXTURE=false

# Other Features
ENABLE_INSIGHTFACE=false  # Face embeddings for repeat users
ENABLE_REPEAT_USER_DETECTION=false
ENABLE_RATE_LIMITING=true
ENABLE_CACHING=true

# -----------------------------------------------------------------------------
# Rate Limiting
# -----------------------------------------------------------------------------
RATE_LIMIT_PER_MINUTE=20
RATE_LIMIT_BURST=5

# -----------------------------------------------------------------------------
# Message Queue (RabbitMQ)
# -----------------------------------------------------------------------------
RABBITMQ_URL=amqp://guest:guest@rabbitmq:5672/
RABBITMQ_QUEUE=facial_analysis
RABBITMQ_EXCHANGE=facial_analysis_exchange

# -----------------------------------------------------------------------------
# Monitoring & Logging
# -----------------------------------------------------------------------------
LOG_LEVEL=INFO  # DEBUG | INFO | WARNING | ERROR
LOG_FORMAT=json  # json | text

# Prometheus
ENABLE_METRICS=false
METRICS_PORT=9090

# Sentry (Optional)
SENTRY_DSN=
SENTRY_ENVIRONMENT=production

# -----------------------------------------------------------------------------
# Performance Tuning
# -----------------------------------------------------------------------------
# Request timeouts (seconds)
REQUEST_TIMEOUT=30
MODEL_INFERENCE_TIMEOUT=10
CLAUDE_API_TIMEOUT=30

# Parallel processing
MAX_PARALLEL_MODELS=10
USE_ASYNC_PROCESSING=true

# -----------------------------------------------------------------------------
# Security
# -----------------------------------------------------------------------------
# API Authentication
API_KEY_HEADER=X-API-Key
REQUIRE_API_KEY=false  # Set true in production

# HTTPS (for production)
USE_HTTPS=false
SSL_CERT_PATH=/etc/ssl/certs/cert.pem
SSL_KEY_PATH=/etc/ssl/private/key.pem

# -----------------------------------------------------------------------------
# Frontend
# -----------------------------------------------------------------------------
REACT_APP_API_URL=http://localhost:8000
REACT_APP_WS_URL=ws://localhost:8000
REACT_APP_ENABLE_ANALYTICS=false

# -----------------------------------------------------------------------------
# Development
# -----------------------------------------------------------------------------
DEBUG=false
HOT_RELOAD=false
ENABLE_CORS=true

# -----------------------------------------------------------------------------
# Model Downloads
# -----------------------------------------------------------------------------
HUGGINGFACE_CACHE_DIR=./models/huggingface
MODEL_DOWNLOAD_TIMEOUT=600

# HuggingFace Hub (optional, for private models)
HUGGINGFACE_TOKEN=

# -----------------------------------------------------------------------------
# Deployment
# -----------------------------------------------------------------------------
# AWS (if deploying to AWS)
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
S3_BUCKET=

# Google Cloud (if deploying to GCP)
GOOGLE_CLOUD_PROJECT=
GOOGLE_APPLICATION_CREDENTIALS=

# Azure (if deploying to Azure)
AZURE_STORAGE_ACCOUNT=
AZURE_STORAGE_KEY=

# -----------------------------------------------------------------------------
# Backup & Retention
# -----------------------------------------------------------------------------
# Auto-delete old images (days)
IMAGE_RETENTION_DAYS=30

# Database backup
DB_BACKUP_ENABLED=true
DB_BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM

# =============================================================================
# END OF CONFIGURATION
# =============================================================================
